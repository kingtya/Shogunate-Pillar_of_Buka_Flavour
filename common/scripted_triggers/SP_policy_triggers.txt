sp_can_release_policy = {
	trigger_if = {
		limit = {
			exists = $FLAG$
		}
		custom_description = {
			text = sp_policy_released_cd
			trigger_if = {
				limit = {
					has_variable_list = sp_released_policy_flags
				}
				NOT = {
					any_in_list = {
						variable = sp_released_policy_flags
						this = $FLAG$
					}
				}
				
			}
			trigger_else = {
				always = yes
			}
		}
		custom_description = {
			text = sp_contraditory_policy_released_cd
			trigger_if = {
				limit = {
					has_variable_list = sp_released_policy_flags
					$FLAG$ = flag:flag_sp_policy_official_purveyor
				}
				NOT = {
					any_in_list = {
						variable = sp_released_policy_flags
						this = flag:flag_sp_policy_easy_commerce
					}
				}
			}
			trigger_if = {
				limit = {
					has_variable_list = sp_released_policy_flags
					$FLAG$ = flag:flag_sp_policy_easy_commerce
				}
				NOT = {
					any_in_list = {
						variable = sp_released_policy_flags
						this = flag:flag_sp_policy_official_purveyor
					}
				}
			}
			trigger_else = {
				always = yes
			}

		}
		custom_description = {
			text = sp_policy_need_more_points_cd
	
			trigger_if = {
				limit = {
					exists = root.var:sp_policy_will_be_points
				}
				root.var:sp_policy_will_be_points <= root.sp_total_policy_points
			}
			trigger_else = {
				always = no
			}

		}
		custom_description = {
			text = sp_policy_is_locked_cd
			trigger_if = {
				limit = {
					$FLAG$ = flag:flag_sp_policy_laws_of_imagawa
				}
				sp_has_imagawa_margin_trait = yes
			}
			trigger_if = {
				limit = {
					$FLAG$ = flag:flag_sp_policy_laws_of_takeda
				}
				sp_has_takeda_margin_trait = yes
			}
			trigger_if = {
				limit = {
					$FLAG$ = flag:flag_sp_policy_five_admonitions
				}
				sp_has_hojo_margin_trait = yes
			}
			trigger_if = {
				limit = {
					$FLAG$ = flag:flag_sp_policy_guardian_forces
				}
				sp_has_tokugawa_margin_trait = yes
			}
			trigger_if = {
				limit = {
					$FLAG$ = flag:flag_sp_policy_intensive_firearms
				}
				sp_culture_has_innovation_advanced_bowmaking = yes
				sp_has_oda_margin_trait = yes
				any_in_list = {
					variable = sp_released_policy_flags
					this = flag:flag_sp_policy_improve_firearms
				}
			}
			trigger_if = {
				limit = {
					$FLAG$ = flag:flag_sp_policy_dragon_corps
				}
				sp_culture_has_innovation_advanced_bowmaking = yes
				sp_has_date_margin_trait = yes
			}
			trigger_if = {
				limit = {
					$FLAG$ = flag:flag_sp_policy_chivalry_education
				}
				sp_has_shimazu_margin_trait = yes
			}
			trigger_if = {
				limit = {
					$FLAG$ = flag:flag_sp_policy_expeditionary_support
				}
				sp_has_uesugi_margin_trait = yes
			}
			trigger_if = {
				limit = {
					$FLAG$ = flag:flag_sp_policy_million_minds_motto
				}
				sp_has_mori_margin_trait = yes
			}
			trigger_if = {
				limit = {
					$FLAG$ = flag:flag_sp_policy_armoured_militia
				}
				sp_has_chosokabe_margin_trait = yes
			}
			trigger_if = {
				limit = {
					$FLAG$ = flag:flag_sp_policy_six_coins_oath
				}
				sp_has_sanada_margin_trait = yes
			}
			trigger_if = {
				limit = {
					$FLAG$ = flag:flag_sp_policy_cunning_strategy
				}
				sp_has_sanada_margin_trait_2 = yes
			}
			trigger_if = {
				limit = {
					$FLAG$ = flag:flag_sp_policy_sanada_red_armour
				}
				sp_has_sanada_margin_trait = yes
			}
			trigger_if = {
				limit = {
					$FLAG$ = flag:flag_sp_policy_progressive_system
				}
				OR = {
					NOT = { has_variable_list = sp_released_policy_flags }
					any_in_list = {
						variable = sp_released_policy_flags
						count <= 0
					}
				}

			}
			trigger_else = {
				always = yes
			}
		}
	}
	trigger_else = {
		always = no
	}
	
}

sp_culture_has_innovation_advanced_bowmaking = {
	culture = {
		has_innovation = innovation_advanced_bowmaking
	}
}

sp_culture_has_innovation_guilds = {
	culture = {
		has_innovation = innovation_guilds
	}
}

sp_culture_has_innovation_royal_armory = {
	culture = {
		has_innovation = innovation_royal_armory
	}
}

sp_can_revoke_policy = {
	trigger_if = {
		limit = {
			exists = $FLAG$
		}
		custom_description = {
			text = sp_policy_not_released_cd
			trigger_if = {
				limit = {
					has_variable_list = sp_released_policy_flags
				}
				any_in_list = {
					variable = sp_released_policy_flags
					this = $FLAG$
				}
			}
			trigger_else = {
				always = no
			}
		}

		custom_description = {
			text = sp_policy_released_recently_cd
			trigger_if = {
				limit = {
					trigger_if = {
						limit = {
							has_variable_list = sp_released_policy_flags
						}
						any_in_list = {
							variable = sp_released_policy_flags
							this = $FLAG$
						}
						
					}
					trigger_else = {
						always = no
					}
				}
				NOT = {
					has_character_flag = $FLAG$
				}
			}
			trigger_else = {
				always = yes
			}
		}
	}
	trigger_else = {
		always = no
	}
	
}

sp_is_released_policy = {
	trigger_if = {
		limit = {
			has_variable_list = sp_released_policy_flags
		}
		any_in_list = {
			variable = sp_released_policy_flags
			this = $FLAG$
		}
	}
	trigger_else = {
		always = no
	}
}